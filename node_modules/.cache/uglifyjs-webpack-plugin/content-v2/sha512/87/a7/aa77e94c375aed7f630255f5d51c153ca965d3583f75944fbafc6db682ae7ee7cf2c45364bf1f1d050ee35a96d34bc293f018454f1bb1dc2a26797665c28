{"code":"!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,\"a\",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p=\"\",n(n.s=0)}([function(t,e,n){\"use strict\";n.r(e);class i{constructor(t,e,n){this._map=e,this._ecOptions=t,this._registered=!1,this._container=null,this.zIndex=999,this._container=null,this._echarts=n}getMap(){return this._map}show(){this._container&&(this._container.style.display=\"\")}_isVisible(){return this._container&&\"\"===this._container.style.display}render(){this._map.once(\"postrender\",this._render.bind(this))}_render(){this._container||this._createLayerContainer(),this._ec?this._isVisible()&&this._ec.resize():(this._ec=this._echarts.init(this._container),this._prepareECharts(),this._ec.setOption(this._ecOptions,!1)),this._bindEvent()}_bindEvent(){this._map.on(\"pointerdrag\",this._moveHandler(\"onMoveEnd\")),this._map.getView().on(\"change:resolution\",this._moveHandler(\"onMoveEnd\"))}_moveHandler(t){return this[t].bind(this)}_prepareECharts(){this._registered||(this._echarts.registerCoordinateSystem(\"openlayers\",this._getE3CoordinateSystem(this.getMap())),this._registered=!0);var t=this._ecOptions.series;if(t)for(var e=t.length-1;e>=0;e--)t[e].coordinateSystem=\"openlayers\",t[e].animation=!1}_createLayerContainer(){var t=this._map.getSize(),e=this._container=i.Element.createDiv(\"e_container\",{height:t[1]+\"px\",width:t[0]+\"px\",top:\"0px\",left:\"0px\",zIndex:999});this._zIndex&&(e.style.zIndex=this._zIndex),this._resetContainer(),this._map.getViewport().appendChild(this._container)}_resetContainer(){var t=this.getMap().getSize();this._container.style.width=t.width+\"px\",this._container.style.height=t.height+\"px\"}_getE3CoordinateSystem(t){var e=function(t){this.map=t,this._mapOffset=[0,0]};return e.create=function(n){n.eachSeries(function(n){\"openlayers\"===n.get(\"coordinateSystem\")&&(n.coordinateSystem=new e(t))})},e.getDimensionsInfo=function(){return[\"x\",\"y\"]},e.dimensions=[\"x\",\"y\"],e.prototype.dimensions=[\"x\",\"y\"],e.prototype.setMapOffset=function(t){this._mapOffset=t},e.prototype.dataToPoint=function(t){var e=this.map.getPixelFromCoordinate(t),n=this._mapOffset;return[e[0]-n[0],e[1]-n[1]]},e.prototype.pointToData=function(t){var e=this._mapOffset,n=this.map.containerPointToCoordinate({x:t[0]+e[0],y:t[1]+e[1]});return[n.x,n.y]},e.prototype.getViewRect=function(){var t=this.map.getSize();return new this._echarts.graphic.BoundingRect(0,0,t.width,t.height)},e.prototype.getRoamTransform=function(){return this._echarts.matrix.create()},e}getEvents(){return{_zoomstart:this.onZoomStart,_zoomend:this.onZoomEnd,_dragrotatestart:this.onDragRotateStart,_dragrotateend:this.onDragRotateEnd,_movestart:this.onMoveStart,_moveend:this.onMoveEnd,_resize:this._resetContainer}}_clearAndRedraw(){this._container&&\"none\"===this._container.style.display||(this._ec.clear(),this._ec.resize(),this._prepareECharts(),this._ec.setOption(this._ecOptions,!1))}onZoomStart(){this.hide()}onZoomEnd(){this._clearAndRedraw()}onDragRotateStart(){this.hide()}onDragRotateEnd(){this._clearAndRedraw()}onMoveStart(){this.hide()}show(){this._container&&(this._container.style.display=\"\")}onMoveEnd(){this._ec.setOption(this._ecOptions,!1)}}i.Element={createDiv:function(t,e){if(!t)return console.error(\"id不能为空\");var n=document.createElement(\"div\");return n.id=t,n.style.position=\"absolute\",i.Element.modifyDomStyle(n,e),n},modifyDomStyle:function(t,e){e&&(e.height&&(t.style.height=e.height),e.width&&(t.style.width=e.width),e.border&&(t.style.border=e.border),e.transition&&(t.style.transition=e.transition),e.color&&(t.style.color=e.color),e.lineHeight&&(t.style.lineHeight=e.lineHeight),e.borderRadius&&(t.style.borderRadius=e.borderRadius),e.textAlign&&(t.style.textAlign=e.textAlign),e.backgroundColor&&(t.style.backgroundColor=e.backgroundColor),e.zIndex&&(t.style.zIndex=e.zIndex),e.top&&(t.style.top=e.top),e.left&&(t.style.left=e.left))},setDomPosition:function(t,e){t.style.top=e[0]+\"px\",t.style.left=e[1]+\"px\"},setDomContent:function(t,e){t.innerHTML=e},append:function(t,e){if(\"string\"==typeof t){if(!e)return document.body.innerHTML=t;if(n=document.getElementById(e))return n.innerHTML=t}else{if(!e)return document.body.appendChild(t);var n;if(n=document.getElementById(e))return n.appendChild(t)}},getDomStyle:function(t,e){return t.style[e]},getDomCenter:function(t,e){var n=\"100%\",r=\"100%\",o=0,s=0;if(e){var a=document.getElementById(e);if(!a)return console.error(\"未能找到id为\"+e+\"的元素\");n=i.Element.getDomStyle(a,\"height\"),r=i.Element.getDomStyle(a,\"width\")}else n=document.body.offsetHeight,r=document.body.offsetWidth;return t?(o=i.Element.getDomStyle(t,\"height\"),s=i.Element.getDomStyle(t,\"width\"),[(parseInt(n)-parseInt(o))/2,(parseInt(r)-parseInt(s))/2]):console.error(\"未提供dom元素\")}},window.ADLayer=i,e.default=i}]);","extractedComments":[]}