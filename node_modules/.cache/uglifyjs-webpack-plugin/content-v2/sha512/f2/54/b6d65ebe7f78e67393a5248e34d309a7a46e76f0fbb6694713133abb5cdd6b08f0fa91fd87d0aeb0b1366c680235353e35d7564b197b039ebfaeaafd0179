{"code":"!function(e,t){if(\"object\"==typeof exports&&\"object\"==typeof module)module.exports=t();else if(\"function\"==typeof define&&define.amd)define([],t);else{var n=t();for(var i in n)(\"object\"==typeof exports?exports:e)[i]=n[i]}}(window,function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=0)}([function(e,t,n){\"use strict\";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var o=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this._map=n,this._ecOptions=t,this._registered=!1,this._container=null,this.zIndex=999,this._container=null,this._echarts=i}return i(e,[{key:\"getMap\",value:function(){return this._map}},{key:\"show\",value:function(){this._container&&(this._container.style.display=\"\")}},{key:\"_isVisible\",value:function(){return this._container&&\"\"===this._container.style.display}},{key:\"render\",value:function(){this._map.once(\"postrender\",this._render.bind(this))}},{key:\"_render\",value:function(){this._container||this._createLayerContainer(),this._ec?this._isVisible()&&this._ec.resize():(this._ec=this._echarts.init(this._container),this._prepareECharts(),this._ec.setOption(this._ecOptions,!1)),this._bindEvent()}},{key:\"_bindEvent\",value:function(){this._map.on(\"pointerdrag\",this._moveHandler(\"onMoveEnd\")),this._map.getView().on(\"change:resolution\",this._moveHandler(\"onMoveEnd\"))}},{key:\"_moveHandler\",value:function(e){return this[e].bind(this)}},{key:\"_prepareECharts\",value:function(){this._registered||(this._echarts.registerCoordinateSystem(\"openlayers\",this._getE3CoordinateSystem(this.getMap())),this._registered=!0);var e=this._ecOptions.series;if(e)for(var t=e.length-1;t>=0;t--)e[t].coordinateSystem=\"openlayers\",e[t].animation=!1}},{key:\"_createLayerContainer\",value:function(){var t=this._map.getSize(),n=this._container=e.Element.createDiv(\"e_container\",{height:t[1]+\"px\",width:t[0]+\"px\",top:\"0px\",left:\"0px\",zIndex:999});this._zIndex&&(n.style.zIndex=this._zIndex),this._resetContainer(),this._map.getViewport().appendChild(this._container)}},{key:\"_resetContainer\",value:function(){var e=this.getMap().getSize();this._container.style.width=e.width+\"px\",this._container.style.height=e.height+\"px\"}},{key:\"_getE3CoordinateSystem\",value:function(e){var t=function(e){this.map=e,this._mapOffset=[0,0]};return t.create=function(n){n.eachSeries(function(n){\"openlayers\"===n.get(\"coordinateSystem\")&&(n.coordinateSystem=new t(e))})},t.getDimensionsInfo=function(){return[\"x\",\"y\"]},t.dimensions=[\"x\",\"y\"],t.prototype.dimensions=[\"x\",\"y\"],t.prototype.setMapOffset=function(e){this._mapOffset=e},t.prototype.dataToPoint=function(e){var t=this.map.getPixelFromCoordinate(e),n=this._mapOffset;return[t[0]-n[0],t[1]-n[1]]},t.prototype.pointToData=function(e){var t=this._mapOffset,n=this.map.containerPointToCoordinate({x:e[0]+t[0],y:e[1]+t[1]});return[n.x,n.y]},t.prototype.getViewRect=function(){var e=this.map.getSize();return new this._echarts.graphic.BoundingRect(0,0,e.width,e.height)},t.prototype.getRoamTransform=function(){return this._echarts.matrix.create()},t}},{key:\"getEvents\",value:function(){return{_zoomstart:this.onZoomStart,_zoomend:this.onZoomEnd,_dragrotatestart:this.onDragRotateStart,_dragrotateend:this.onDragRotateEnd,_movestart:this.onMoveStart,_moveend:this.onMoveEnd,_resize:this._resetContainer}}},{key:\"_clearAndRedraw\",value:function(){this._container&&\"none\"===this._container.style.display||(this._ec.clear(),this._ec.resize(),this._prepareECharts(),this._ec.setOption(this._ecOptions,!1))}},{key:\"onZoomStart\",value:function(){this.hide()}},{key:\"onZoomEnd\",value:function(){this._clearAndRedraw()}},{key:\"onDragRotateStart\",value:function(){this.hide()}},{key:\"onDragRotateEnd\",value:function(){this._clearAndRedraw()}},{key:\"onMoveStart\",value:function(){this.hide()}},{key:\"show\",value:function(){this._container&&(this._container.style.display=\"\")}},{key:\"onMoveEnd\",value:function(){this._ec.setOption(this._ecOptions,!1)}}]),e}();o.Element={createDiv:function(e,t){if(!e)return console.error(\"id不能为空\");var n=document.createElement(\"div\");return n.id=e,n.style.position=\"absolute\",o.Element.modifyDomStyle(n,t),n},modifyDomStyle:function(e,t){t&&(t.height&&(e.style.height=t.height),t.width&&(e.style.width=t.width),t.border&&(e.style.border=t.border),t.transition&&(e.style.transition=t.transition),t.color&&(e.style.color=t.color),t.lineHeight&&(e.style.lineHeight=t.lineHeight),t.borderRadius&&(e.style.borderRadius=t.borderRadius),t.textAlign&&(e.style.textAlign=t.textAlign),t.backgroundColor&&(e.style.backgroundColor=t.backgroundColor),t.zIndex&&(e.style.zIndex=t.zIndex),t.top&&(e.style.top=t.top),t.left&&(e.style.left=t.left))},setDomPosition:function(e,t){e.style.top=t[0]+\"px\",e.style.left=t[1]+\"px\"},setDomContent:function(e,t){e.innerHTML=t},append:function(e,t){if(\"string\"==typeof e){if(!t)return document.body.innerHTML=e;if(n=document.getElementById(t))return n.innerHTML=e}else{if(!t)return document.body.appendChild(e);var n;if(n=document.getElementById(t))return n.appendChild(e)}},getDomStyle:function(e,t){return e.style[t]},getDomCenter:function(e,t){var n=\"100%\",i=\"100%\",r=0,s=0;if(t){var a=document.getElementById(t);if(!a)return console.error(\"未能找到id为\"+t+\"的元素\");n=o.Element.getDomStyle(a,\"height\"),i=o.Element.getDomStyle(a,\"width\")}else n=document.body.offsetHeight,i=document.body.offsetWidth;return e?(r=o.Element.getDomStyle(e,\"height\"),s=o.Element.getDomStyle(e,\"width\"),[(parseInt(n)-parseInt(r))/2,(parseInt(i)-parseInt(s))/2]):console.error(\"未提供dom元素\")}}}])});","extractedComments":[]}